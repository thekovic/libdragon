<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: fmath.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">fmath.h File Reference<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__fastmath.html">Fast math routines</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Fast math routines, optimized for 3D graphics calculations.  
<a href="#details">More...</a></p>

<p><a href="fmath_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9cbc769eaa2ac0468964138e7507ab3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#a9cbc769eaa2ac0468964138e7507ab3b">BITCAST_F2I</a>(f)&#160;&#160;&#160;({ int32_t i; memcpy(&amp;i, &amp;f, 4); i; })</td></tr>
<tr class="memdesc:a9cbc769eaa2ac0468964138e7507ab3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinterpret the bits composing a float as a int32.  <a href="fmath_8h.html#a9cbc769eaa2ac0468964138e7507ab3b">More...</a><br /></td></tr>
<tr class="separator:a9cbc769eaa2ac0468964138e7507ab3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a9889af367af54365a1711df9b25bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#ac6a9889af367af54365a1711df9b25bc">BITCAST_I2F</a>(i)&#160;&#160;&#160;({ float f;   memcpy(&amp;f, &amp;i, 4); f; })</td></tr>
<tr class="memdesc:ac6a9889af367af54365a1711df9b25bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinterpret the bits composing a int32 as a float.  <a href="fmath_8h.html#ac6a9889af367af54365a1711df9b25bc">More...</a><br /></td></tr>
<tr class="separator:ac6a9889af367af54365a1711df9b25bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac0a97f3dfd3b642796b582bba56b1c4b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b">fm_sinf</a> (float x)</td></tr>
<tr class="memdesc:ac0a97f3dfd3b642796b582bba56b1c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faster version of sinf.  <a href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b">More...</a><br /></td></tr>
<tr class="separator:ac0a97f3dfd3b642796b582bba56b1c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34b2332699e12db0839346543f11b59"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#ad34b2332699e12db0839346543f11b59">fm_sinf_approx</a> (float x, int approx)</td></tr>
<tr class="memdesc:ad34b2332699e12db0839346543f11b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faster version of sinf, with tunable approximation level.  <a href="fmath_8h.html#ad34b2332699e12db0839346543f11b59">More...</a><br /></td></tr>
<tr class="separator:ad34b2332699e12db0839346543f11b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711cab47fa17a28332c596e02431ee2c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#a711cab47fa17a28332c596e02431ee2c">fm_cosf</a> (float x)</td></tr>
<tr class="memdesc:a711cab47fa17a28332c596e02431ee2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faster version of cosf.  <a href="fmath_8h.html#a711cab47fa17a28332c596e02431ee2c">More...</a><br /></td></tr>
<tr class="separator:a711cab47fa17a28332c596e02431ee2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbd8054386ddb7bc9fdb9027006941fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#afbd8054386ddb7bc9fdb9027006941fb">fm_sincosf</a> (float x, float *sin, float *cos)</td></tr>
<tr class="memdesc:afbd8054386ddb7bc9fdb9027006941fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faster version of sincosf.  <a href="fmath_8h.html#afbd8054386ddb7bc9fdb9027006941fb">More...</a><br /></td></tr>
<tr class="separator:afbd8054386ddb7bc9fdb9027006941fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5306110233e1820d066c74740277ad1"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fmath_8h.html#ab5306110233e1820d066c74740277ad1">fm_atan2f</a> (float y, float x)</td></tr>
<tr class="memdesc:ab5306110233e1820d066c74740277ad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faster version of atan2f.  <a href="fmath_8h.html#ab5306110233e1820d066c74740277ad1">More...</a><br /></td></tr>
<tr class="separator:ab5306110233e1820d066c74740277ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Fast math routines, optimized for 3D graphics calculations. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a9cbc769eaa2ac0468964138e7507ab3b" name="a9cbc769eaa2ac0468964138e7507ab3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cbc769eaa2ac0468964138e7507ab3b">&#9670;&nbsp;</a></span>BITCAST_F2I</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BITCAST_F2I</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td>&#160;&#160;&#160;({ int32_t i; memcpy(&amp;i, &amp;f, 4); i; })</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinterpret the bits composing a float as a int32. </p>
<p >This version is type-punning safe and produces optimal code when optimizing. </p>

</div>
</div>
<a id="ac6a9889af367af54365a1711df9b25bc" name="ac6a9889af367af54365a1711df9b25bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a9889af367af54365a1711df9b25bc">&#9670;&nbsp;</a></span>BITCAST_I2F</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BITCAST_I2F</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">i</td><td>)</td>
          <td>&#160;&#160;&#160;({ float f;   memcpy(&amp;f, &amp;i, 4); f; })</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinterpret the bits composing a int32 as a float. </p>
<p >This version is type-punning safe and produces optimal code when optimizing. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac0a97f3dfd3b642796b582bba56b1c4b" name="ac0a97f3dfd3b642796b582bba56b1c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a97f3dfd3b642796b582bba56b1c4b">&#9670;&nbsp;</a></span>fm_sinf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float fm_sinf </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Faster version of sinf. </p>
<p >This function computes a very accurate approximation of the sine of a floating point number, as long as the argument as a small magnitude. Do not use this function with very large (positive or negative) numbers as the accuracy decreases. Normally, it is not necessary in graphics programming to compute trigonometric functions on angles of unbounded magnitude.</p>
<p >The functions runs in about ~50 ticks, versus ~800 ticks of the newlib version. The accuracy in the range [-π, +π] is within 5 ULP of the correct result, but the argument reduction to bring the argument in that range introduces errors which increase with the magnitude of the operand. </p>

</div>
</div>
<a id="ad34b2332699e12db0839346543f11b59" name="ad34b2332699e12db0839346543f11b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34b2332699e12db0839346543f11b59">&#9670;&nbsp;</a></span>fm_sinf_approx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float fm_sinf_approx </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>approx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Faster version of sinf, with tunable approximation level. </p>
<p >This function is similar to <a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a>, but allows to further speedup the approximation by reducing the number of calculated terms. <a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a> in fact is pretty accurate (~ 5 ULP) but some times much less precision is required.</p>
<p >The approximation level is a number between 0 and 5, where 0 is the most accurate version (identical to <a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a>) and 5 is the fastest one. We do not give mathematical guarantees on the accuracy of the approximation, and we suggest on holistic approach (try and see if it works for you).</p>
<p >This function is suggested in all cases in which you need to visually reproduce a "sinewave" effect, but you do not care about the exact numbers behind it. For trigonemetric formulas that includes a sine (eg: matrix rotations), it is suggested to use <a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a> instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The angle in radians </td></tr>
    <tr><td class="paramname">approx</td><td>The approximation level, between 0 and 5 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a711cab47fa17a28332c596e02431ee2c" name="a711cab47fa17a28332c596e02431ee2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a711cab47fa17a28332c596e02431ee2c">&#9670;&nbsp;</a></span>fm_cosf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float fm_cosf </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Faster version of cosf. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a> for considerations on why and how to use this functions instead of the standard sinf. </dd></dl>

</div>
</div>
<a id="afbd8054386ddb7bc9fdb9027006941fb" name="afbd8054386ddb7bc9fdb9027006941fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbd8054386ddb7bc9fdb9027006941fb">&#9670;&nbsp;</a></span>fm_sincosf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fm_sincosf </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>sin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>cos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Faster version of sincosf. </p>
<p >Similar to <a class="el" href="fmath_8h.html#ac0a97f3dfd3b642796b582bba56b1c4b" title="Faster version of sinf.">fm_sinf</a> and <a class="el" href="fmath_8h.html#a711cab47fa17a28332c596e02431ee2c" title="Faster version of cosf.">fm_cosf</a>, but calculates both sinf and cosf for the same angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The angle in radians </td></tr>
    <tr><td class="paramname">sin</td><td>The pointer to the variable that will contain the sine </td></tr>
    <tr><td class="paramname">cos</td><td>The pointer to the variable that will contain the cosine </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab5306110233e1820d066c74740277ad1" name="ab5306110233e1820d066c74740277ad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5306110233e1820d066c74740277ad1">&#9670;&nbsp;</a></span>fm_atan2f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float fm_atan2f </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Faster version of atan2f. </p>
<p >Given a point (x,y), return the angle in radians that the vector (x,y) forms with the X axis. This is the same of arctan(y/x).</p>
<p >This function runs in about ~XX ticks, versus ~YY ticks of the newlib version. The maximum measured error is ~6.14e-4, which is usually more than enough in the context of angles. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
