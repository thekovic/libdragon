<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: rdpq_tri.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_e82f31e8932771ae6769214a98ceba7f.html">rdpq</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">rdpq_tri.c File Reference<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__display.html">Display Subsystem</a> &raquo; <a class="el" href="group__rdp.html">(Deprecated) Old RDP library</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>RDP Command queue: triangle drawing routine.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structrdpq__tri__edge__data__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#structrdpq__tri__edge__data__t">rdpq_tri_edge_data_t</a></td></tr>
<tr class="memdesc:structrdpq__tri__edge__data__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precomputed information about edges and slopes.  <a href="rdpq__tri_8c.html#structrdpq__tri__edge__data__t">More...</a><br /></td></tr>
<tr class="separator:structrdpq__tri__edge__data__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4fd43a3da50a4816e28658a666d90e03"><td class="memItemLeft" align="right" valign="top"><a id="a4fd43a3da50a4816e28658a666d90e03" name="a4fd43a3da50a4816e28658a666d90e03"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TRIANGLE_TRACE</b>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a4fd43a3da50a4816e28658a666d90e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to 1 to activate tracing of all parameters of all triangles. <br /></td></tr>
<tr class="separator:a4fd43a3da50a4816e28658a666d90e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb613ddfceb7573a840c84b146f273c"><td class="memItemLeft" align="right" valign="top"><a id="a1fb613ddfceb7573a840c84b146f273c" name="a1fb613ddfceb7573a840c84b146f273c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>tracef</b>(fmt, ...)&#160;&#160;&#160;({ })</td></tr>
<tr class="memdesc:a1fb613ddfceb7573a840c84b146f273c"><td class="mdescLeft">&#160;</td><td class="mdescRight">like <a class="el" href="debug_8h.html#aa3e8be416ef1525cfd3230204b56d184" title="Write a message to the debugging channel.">debugf()</a>, but writes only if <a class="el" href="rdpq__tri_8c.html#a4fd43a3da50a4816e28658a666d90e03" title="Set to 1 to activate tracing of all parameters of all triangles.">TRIANGLE_TRACE</a> is not 0 <br /></td></tr>
<tr class="separator:a1fb613ddfceb7573a840c84b146f273c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:add1e792a78af68f486e3c73e74faee77"><td class="memItemLeft" align="right" valign="top"><a id="add1e792a78af68f486e3c73e74faee77" name="add1e792a78af68f486e3c73e74faee77"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rdpq_triangle_cpu</b> (const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> *fmt, const float *v1, const float *v2, const float *v3)</td></tr>
<tr class="memdesc:add1e792a78af68f486e3c73e74faee77"><td class="mdescLeft">&#160;</td><td class="mdescRight">RDP triangle primitive assembled on the CPU. <br /></td></tr>
<tr class="separator:add1e792a78af68f486e3c73e74faee77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b920a91e60da1f3abea7e23cfea43b"><td class="memItemLeft" align="right" valign="top"><a id="a78b920a91e60da1f3abea7e23cfea43b" name="a78b920a91e60da1f3abea7e23cfea43b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rdpq_triangle_rsp</b> (const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> *fmt, const float *v1, const float *v2, const float *v3)</td></tr>
<tr class="memdesc:a78b920a91e60da1f3abea7e23cfea43b"><td class="mdescLeft">&#160;</td><td class="mdescRight">RDP triangle primitive assembled on the RSP. <br /></td></tr>
<tr class="separator:a78b920a91e60da1f3abea7e23cfea43b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb11d915a7ce8903b2b3e5ed9ef7936e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#afb11d915a7ce8903b2b3e5ed9ef7936e">rdpq_triangle</a> (const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> *fmt, const float *v1, const float *v2, const float *v3)</td></tr>
<tr class="memdesc:afb11d915a7ce8903b2b3e5ed9ef7936e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw a triangle (RDP command: TRI_*)  <a href="rdpq__tri_8c.html#afb11d915a7ce8903b2b3e5ed9ef7936e">More...</a><br /></td></tr>
<tr class="separator:afb11d915a7ce8903b2b3e5ed9ef7936e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a614234de275518683c066ffc6c381503"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#a614234de275518683c066ffc6c381503">TRIFMT_FILL</a></td></tr>
<tr class="memdesc:a614234de275518683c066ffc6c381503"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a solid-filled triangle.  <a href="rdpq__tri_8c.html#a614234de275518683c066ffc6c381503">More...</a><br /></td></tr>
<tr class="separator:a614234de275518683c066ffc6c381503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd045f775e19f71383478d682426dd95"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#abd045f775e19f71383478d682426dd95">TRIFMT_SHADE</a></td></tr>
<tr class="memdesc:abd045f775e19f71383478d682426dd95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a shaded triangle.  <a href="rdpq__tri_8c.html#abd045f775e19f71383478d682426dd95">More...</a><br /></td></tr>
<tr class="separator:abd045f775e19f71383478d682426dd95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7feb9dc8632c32b6115680330febebe4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#a7feb9dc8632c32b6115680330febebe4">TRIFMT_TEX</a></td></tr>
<tr class="memdesc:a7feb9dc8632c32b6115680330febebe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a textured triangle.  <a href="rdpq__tri_8c.html#a7feb9dc8632c32b6115680330febebe4">More...</a><br /></td></tr>
<tr class="separator:a7feb9dc8632c32b6115680330febebe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa511d95fd2e16ede6d2fb82509ad962"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#aaa511d95fd2e16ede6d2fb82509ad962">TRIFMT_SHADE_TEX</a></td></tr>
<tr class="memdesc:aaa511d95fd2e16ede6d2fb82509ad962"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a shaded, textured triangle.  <a href="rdpq__tri_8c.html#aaa511d95fd2e16ede6d2fb82509ad962">More...</a><br /></td></tr>
<tr class="separator:aaa511d95fd2e16ede6d2fb82509ad962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb989d6a05daf1f22cc353b55c940ac2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#aeb989d6a05daf1f22cc353b55c940ac2">TRIFMT_ZBUF</a></td></tr>
<tr class="memdesc:aeb989d6a05daf1f22cc353b55c940ac2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a solid-filled, z-buffered triangle.  <a href="rdpq__tri_8c.html#aeb989d6a05daf1f22cc353b55c940ac2">More...</a><br /></td></tr>
<tr class="separator:aeb989d6a05daf1f22cc353b55c940ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7cc145d0307f69db11b13e3f4fa341"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#ada7cc145d0307f69db11b13e3f4fa341">TRIFMT_ZBUF_SHADE</a></td></tr>
<tr class="memdesc:ada7cc145d0307f69db11b13e3f4fa341"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a z-buffered, shaded triangle.  <a href="rdpq__tri_8c.html#ada7cc145d0307f69db11b13e3f4fa341">More...</a><br /></td></tr>
<tr class="separator:ada7cc145d0307f69db11b13e3f4fa341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a214b15e7c1e7abcffd155eecf713cc1a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#a214b15e7c1e7abcffd155eecf713cc1a">TRIFMT_ZBUF_TEX</a></td></tr>
<tr class="memdesc:a214b15e7c1e7abcffd155eecf713cc1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a z-buffered, textured triangle.  <a href="rdpq__tri_8c.html#a214b15e7c1e7abcffd155eecf713cc1a">More...</a><br /></td></tr>
<tr class="separator:a214b15e7c1e7abcffd155eecf713cc1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ee16b45c5d7beff9cee7bf96b01b1c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdpq__tri_8c.html#a42ee16b45c5d7beff9cee7bf96b01b1c">TRIFMT_ZBUF_SHADE_TEX</a></td></tr>
<tr class="memdesc:a42ee16b45c5d7beff9cee7bf96b01b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format descriptor for a z-buffered, shaded, textured triangle.  <a href="rdpq__tri_8c.html#a42ee16b45c5d7beff9cee7bf96b01b1c">More...</a><br /></td></tr>
<tr class="separator:a42ee16b45c5d7beff9cee7bf96b01b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >RDP Command queue: triangle drawing routine. </p>
<p >This file contains the implementation of a single function: <a class="el" href="rdpq__tri_8c.html#afb11d915a7ce8903b2b3e5ed9ef7936e" title="Draw a triangle (RDP command: TRI_*)">rdpq_triangle</a>.</p>
<p >The RDP triangle commands are complex to assemble because they are designed for the hardware that will be drawing them, rather than for the programmer that needs to create them. Specifically, they contain explicit gradients (partial derivatives aka horizontal and vertical per-pixel increments) for all attributes that need to be interpolated. Moreover, the RDP is able to draw triangles with subpixel precision, so input coordinates are fixed point and the setup code must take into account exactly how the rasterizer will handle fractional values. </p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structrdpq__tri__edge__data__t" id="structrdpq__tri__edge__data__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrdpq__tri__edge__data__t">&#9670;&nbsp;</a></span>rdpq_tri_edge_data_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rdpq_tri_edge_data_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >Precomputed information about edges and slopes. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a8a01ee946ec2325e1e7bb9d8d541d4f3" name="a8a01ee946ec2325e1e7bb9d8d541d4f3"></a>float</td>
<td class="fieldname">
hx</td>
<td class="fielddoc">
High edge (X) </td></tr>
<tr><td class="fieldtype">
<a id="a40d9e77758a10fe8d082b72baeee8044" name="a40d9e77758a10fe8d082b72baeee8044"></a>float</td>
<td class="fieldname">
hy</td>
<td class="fielddoc">
High edge (Y) </td></tr>
<tr><td class="fieldtype">
<a id="ad1c1c20ba206875e2e9b287f5a82baa6" name="ad1c1c20ba206875e2e9b287f5a82baa6"></a>float</td>
<td class="fieldname">
mx</td>
<td class="fielddoc">
Middle edge (X) </td></tr>
<tr><td class="fieldtype">
<a id="a2df80859e66e0397507d6a059e5171aa" name="a2df80859e66e0397507d6a059e5171aa"></a>float</td>
<td class="fieldname">
my</td>
<td class="fielddoc">
Middle edge (Y) </td></tr>
<tr><td class="fieldtype">
<a id="a104531e8ce115294cc072941d06be93c" name="a104531e8ce115294cc072941d06be93c"></a>float</td>
<td class="fieldname">
fy</td>
<td class="fielddoc">
Fractional part of Y1 (top vertex) </td></tr>
<tr><td class="fieldtype">
<a id="ad8a7451ce917e105c585e38d8eac5bf0" name="ad8a7451ce917e105c585e38d8eac5bf0"></a>float</td>
<td class="fieldname">
ish</td>
<td class="fielddoc">
Inverse slope of higher edge. </td></tr>
<tr><td class="fieldtype">
<a id="a3e060c897ad2cb3eefabb55cc994542d" name="a3e060c897ad2cb3eefabb55cc994542d"></a>float</td>
<td class="fieldname">
attr_factor</td>
<td class="fielddoc">
Inverse triangle normal (used to calculate gradients) </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afb11d915a7ce8903b2b3e5ed9ef7936e" name="afb11d915a7ce8903b2b3e5ed9ef7936e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb11d915a7ce8903b2b3e5ed9ef7936e">&#9670;&nbsp;</a></span>rdpq_triangle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rdpq_triangle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>v2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float *&#160;</td>
          <td class="paramname"><em>v3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw a triangle (RDP command: TRI_*) </p>
<p >This function allows to draw a triangle into the framebuffer using RDP, in screen coordinates. RDP does not handle transform and lightning, so it only reasons of screen level coordinates.</p>
<p >Each vertex of a triangle is made of up to 4 components:</p>
<ul>
<li>Position. 2 values: X, Y. The values must be in screen coordinates, that is they refer to the framebuffer pixels. Fractional values allow for subpixel precision. Supported range is [-4096..4095] (numbers outside that range will be clamped).</li>
<li>Depth. 1 value: Z. Supported range in [0..1].</li>
<li>Shade. 4 values: R, G, B, A. The values must be in the 0..1 range.</li>
<li>Texturing. 3 values: S, T, INV_W. The values S,T address the texture specified by the tile descriptor. INV_W is the inverse of the W vertex coordinate in clip space (after projection), a value commonly used to do the final perspective division. This value is required to do perspective-corrected texturing.</li>
</ul>
<p >Only the position is mandatory, all other components are optionals, depending on the kind of triangle that needs to be drawn. For instance, specifying only position and shade will allow to draw a gouraud-shaded triangle with no texturing and no z-buffer usage.</p>
<p >The vertex components must be provided via arrays of floating point values. The order of the components within the array is flexible, and can be specified at call time via the <a class="el" href="structrdpq__trifmt__t.html" title="Format descriptor of a triangle.">rdpq_trifmt_t</a> structure.</p>
<p >Notice that it is important to configure the correct render modes before calling this function. Specifically:</p>
<ul>
<li>To use the depth component, you must activate the z-buffer via <a class="el" href="rdpq__mode_8h.html#aad7c343e675e5a482af571b81a079714" title="Activate z-buffer usage.">rdpq_mode_zbuf</a>.</li>
<li>To use the shade component, you must configure a color combiner formula via <a class="el" href="rdpq__mode_8h.html#a7aaec7357eb3343339d9373b1a963a57" title="Configure the color combiner.">rdpq_mode_combiner</a>. The formula must use the SHADE slot, to specify the exact pixel formula that will combine the per-pixel color value with other components, like the texture.</li>
<li>To use the texturing component, you must configure a color combiner formula via <a class="el" href="rdpq__mode_8h.html#a7aaec7357eb3343339d9373b1a963a57" title="Configure the color combiner.">rdpq_mode_combiner</a> that uses the TEX0 (and/or TEX1) slot, such as <a class="el" href="rdpq__macros_8h.html#a604c0361f8fddd15bc3ee3ba198e49ae" title="Draw with a texture. This is standard texture mapping, without any lights. It can be used for rectang...">RDPQ_COMBINER_TEX</a> or <a class="el" href="rdpq__macros_8h.html#ab83cfcb2413f81216c4db6886e18f48d" title="Draw an interpolated color. This can be used for solid, non-textured triangles with per-vertex lighti...">RDPQ_COMBINER_SHADE</a>, to specify the exact pixel formula that will combine the per-pixel color value with other components, like the shade. Moreover, you can activate perspective texturing via <a class="el" href="rdpq__mode_8h.html#a647e0ab41c68805c849389ddc61c9c56" title="Activate perspective correction for textures.">rdpq_mode_persp</a>.</li>
</ul>
<p >If you fail to activate a specific render mode for a provided component, the component will be ignored by RDP. For instance, if you provide S,T,W but do not configure a combiner formula that accesses TEX0, the texture will not be rendered. On the contrary, if you activate a specific render mode but then fail to provide the component (eg: activate z buffering but then fail to provide a depth component), RDP will fall into undefined behavior that can vary from nothing being rendered, garbage on the screen or even a freeze. The rdpq validator will do its best to help you catching these mistakes, so remember to activate it via <a class="el" href="rdpq__debug_8h.html#a55c7e558e4673c0d498a6dc2be1c0792" title="Initialize the RDPQ debugging engine.">rdpq_debug_start</a> whenever you get a surprising result.</p>
<p >For instance, this code snippet will draw a filled triangle, with a flat green color:</p>
<div class="fragment"><div class="line"><span class="comment">// Reset to standard rendering mode.</span></div>
<div class="line"><a class="code hl_function" href="rdpq__mode_8c.html#ac3c29578703de424bea9548ad86bb4af">rdpq_set_mode_standard</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure the combiner for flat-color rendering</span></div>
<div class="line"><a class="code hl_function" href="rdpq__mode_8c.html#a7aaec7357eb3343339d9373b1a963a57">rdpq_mode_combiner</a>(<a class="code hl_define" href="rdpq__macros_8h.html#a623cc6b579a82d6ca5086d3fbba50285">RDPQ_COMBINER_FLAT</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Configure the flat color</span></div>
<div class="line"><a class="code hl_function" href="rdpq_8c.html#ad25a8b6c5eb35fb2253f601c3be24867">rdpq_set_prim_color</a>(<a class="code hl_define" href="group__graphics.html#gae16bab5741f411ec4ef51b0295f6e705">RGBA32</a>(0, 255, 0, 255));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Draw the triangle</span></div>
<div class="line"><span class="keywordtype">float</span> v1[] = { 100, 100 };</div>
<div class="line"><span class="keywordtype">float</span> v2[] = { 200, 200 };</div>
<div class="line"><span class="keywordtype">float</span> v3[] = { 100, 200 };</div>
<div class="line"><a class="code hl_function" href="rdpq__tri_8c.html#afb11d915a7ce8903b2b3e5ed9ef7936e">rdpq_triangle</a>(&amp;<a class="code hl_variable" href="rdpq__tri_8c.html#a614234de275518683c066ffc6c381503">TRIFMT_FILL</a>, v1, v2, v3);</div>
<div class="ttc" id="agroup__graphics_html_gae16bab5741f411ec4ef51b0295f6e705"><div class="ttname"><a href="group__graphics.html#gae16bab5741f411ec4ef51b0295f6e705">RGBA32</a></div><div class="ttdeci">#define RGBA32(rx, gx, bx, ax)</div><div class="ttdoc">Create a color_t from the R,G,B,A components in the RGBA32 range (0-255).</div><div class="ttdef"><b>Definition:</b> graphics.h:74</div></div>
<div class="ttc" id="ardpq_8c_html_ad25a8b6c5eb35fb2253f601c3be24867"><div class="ttname"><a href="rdpq_8c.html#ad25a8b6c5eb35fb2253f601c3be24867">rdpq_set_prim_color</a></div><div class="ttdeci">void rdpq_set_prim_color(color_t color)</div><div class="ttdoc">Set the RDP PRIM combiner register (color only) (RDP command: SET_PRIM_COLOR)</div><div class="ttdef"><b>Definition:</b> rdpq.h:949</div></div>
<div class="ttc" id="ardpq__macros_8h_html_a623cc6b579a82d6ca5086d3fbba50285"><div class="ttname"><a href="rdpq__macros_8h.html#a623cc6b579a82d6ca5086d3fbba50285">RDPQ_COMBINER_FLAT</a></div><div class="ttdeci">#define RDPQ_COMBINER_FLAT</div><div class="ttdoc">Draw a flat color. Configure the color via rdpq_set_prim_color.</div><div class="ttdef"><b>Definition:</b> rdpq_macros.h:468</div></div>
<div class="ttc" id="ardpq__mode_8c_html_a7aaec7357eb3343339d9373b1a963a57"><div class="ttname"><a href="rdpq__mode_8c.html#a7aaec7357eb3343339d9373b1a963a57">rdpq_mode_combiner</a></div><div class="ttdeci">void rdpq_mode_combiner(rdpq_combiner_t comb)</div><div class="ttdoc">Configure the color combiner.</div><div class="ttdef"><b>Definition:</b> rdpq_mode.h:465</div></div>
<div class="ttc" id="ardpq__mode_8c_html_ac3c29578703de424bea9548ad86bb4af"><div class="ttname"><a href="rdpq__mode_8c.html#ac3c29578703de424bea9548ad86bb4af">rdpq_set_mode_standard</a></div><div class="ttdeci">void rdpq_set_mode_standard(void)</div><div class="ttdoc">Reset render mode to standard.</div><div class="ttdef"><b>Definition:</b> rdpq_mode.c:92</div></div>
<div class="ttc" id="ardpq__tri_8c_html_a614234de275518683c066ffc6c381503"><div class="ttname"><a href="rdpq__tri_8c.html#a614234de275518683c066ffc6c381503">TRIFMT_FILL</a></div><div class="ttdeci">const rdpq_trifmt_t TRIFMT_FILL</div><div class="ttdoc">Format descriptor for a solid-filled triangle.</div><div class="ttdef"><b>Definition:</b> rdpq_tri.c:39</div></div>
<div class="ttc" id="ardpq__tri_8c_html_afb11d915a7ce8903b2b3e5ed9ef7936e"><div class="ttname"><a href="rdpq__tri_8c.html#afb11d915a7ce8903b2b3e5ed9ef7936e">rdpq_triangle</a></div><div class="ttdeci">void rdpq_triangle(const rdpq_trifmt_t *fmt, const float *v1, const float *v2, const float *v3)</div><div class="ttdoc">Draw a triangle (RDP command: TRI_*)</div><div class="ttdef"><b>Definition:</b> rdpq_tri.c:533</div></div>
</div><!-- fragment --><p >The three vertices (v1, v2, v3) can be provided in any order (clockwise or counter-clockwise). The function will render the triangle in any case (so back-face culling must be handled before calling it).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmt</td><td>Format of the triangle being drawn. This structure specifies the order of the components within the vertex arrays, and also some additional rasterization parameters. You can pass one of the predefined formats (<a class="el" href="rdpq__tri_8c.html#a614234de275518683c066ffc6c381503" title="Format descriptor for a solid-filled triangle.">TRIFMT_FILL</a>, <a class="el" href="rdpq__tri_8c.html#a7feb9dc8632c32b6115680330febebe4" title="Format descriptor for a textured triangle.">TRIFMT_TEX</a>, etc.), or a custom one. </td></tr>
    <tr><td class="paramname">v1</td><td>Array of components for vertex 1 </td></tr>
    <tr><td class="paramname">v2</td><td>Array of components for vertex 2 </td></tr>
    <tr><td class="paramname">v3</td><td>Array of components for vertex 3 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a614234de275518683c066ffc6c381503" name="a614234de275518683c066ffc6c381503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a614234de275518683c066ffc6c381503">&#9670;&nbsp;</a></span>TRIFMT_FILL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_FILL</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = -1, .tex_offset = -1, .z_offset = -1,</div>
<div class="line">}</div>
<div class="ttc" id="astructrdpq__trifmt__t_html"><div class="ttname"><a href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a></div><div class="ttdoc">Format descriptor of a triangle.</div><div class="ttdef"><b>Definition:</b> rdpq_tri.h:34</div></div>
</div><!-- fragment -->
<p>Format descriptor for a solid-filled triangle. </p>
<p >Vertex array format: <code>(float){X, Y}</code> (2 floats)</p>
<p >Given that only position is provided, the triangle is drawn with a solid color, which is the output of the color combiner. See <a class="el" href="rdpq__mode_8h.html#a7aaec7357eb3343339d9373b1a963a57" title="Configure the color combiner.">rdpq_mode_combiner</a> for more information.</p>
<p >A common choice for a combiner formula is <a class="el" href="rdpq__macros_8h.html#a623cc6b579a82d6ca5086d3fbba50285" title="Draw a flat color. Configure the color via rdpq_set_prim_color.">RDPQ_COMBINER_FLAT</a>, that will simply output whatever color is configured via <a class="el" href="rdpq_8h.html#ad25a8b6c5eb35fb2253f601c3be24867" title="Set the RDP PRIM combiner register (color only) (RDP command: SET_PRIM_COLOR)">rdpq_set_prim_color</a>. </p>

</div>
</div>
<a id="abd045f775e19f71383478d682426dd95" name="abd045f775e19f71383478d682426dd95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd045f775e19f71383478d682426dd95">&#9670;&nbsp;</a></span>TRIFMT_SHADE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_SHADE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = 2, .tex_offset = -1, .z_offset = -1,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a shaded triangle. </p>
<p >Vertex array format: <code>(float){X, Y, R, G, B, A}</code> (6 floats) </p>

</div>
</div>
<a id="a7feb9dc8632c32b6115680330febebe4" name="a7feb9dc8632c32b6115680330febebe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7feb9dc8632c32b6115680330febebe4">&#9670;&nbsp;</a></span>TRIFMT_TEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_TEX</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = -1, .tex_offset = 2, .z_offset = -1,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a textured triangle. </p>
<p >Vertex array format: <code>(float){X, Y, S, T, INV_W}</code> (5 floats) </p>

</div>
</div>
<a id="aaa511d95fd2e16ede6d2fb82509ad962" name="aaa511d95fd2e16ede6d2fb82509ad962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa511d95fd2e16ede6d2fb82509ad962">&#9670;&nbsp;</a></span>TRIFMT_SHADE_TEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_SHADE_TEX</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = 2, .tex_offset = 6, .z_offset = -1,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a shaded, textured triangle. </p>
<p >Vertex array format: <code>(float){X, Y, R, G, B, A, S, T, INV_W}</code> (9 floats) </p>

</div>
</div>
<a id="aeb989d6a05daf1f22cc353b55c940ac2" name="aeb989d6a05daf1f22cc353b55c940ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb989d6a05daf1f22cc353b55c940ac2">&#9670;&nbsp;</a></span>TRIFMT_ZBUF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_ZBUF</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = -1, .tex_offset = -1, .z_offset = 2,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a solid-filled, z-buffered triangle. </p>
<p >Vertex array format: <code>(float){X, Y, Z}</code> (3 floats) </p>

</div>
</div>
<a id="ada7cc145d0307f69db11b13e3f4fa341" name="ada7cc145d0307f69db11b13e3f4fa341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada7cc145d0307f69db11b13e3f4fa341">&#9670;&nbsp;</a></span>TRIFMT_ZBUF_SHADE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_ZBUF_SHADE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = 3, .tex_offset = -1, .z_offset = 2,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a z-buffered, shaded triangle. </p>
<p >Vertex array format: <code>(float){X, Y, Z, R, G, B, A}</code> (7 floats) </p>

</div>
</div>
<a id="a214b15e7c1e7abcffd155eecf713cc1a" name="a214b15e7c1e7abcffd155eecf713cc1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a214b15e7c1e7abcffd155eecf713cc1a">&#9670;&nbsp;</a></span>TRIFMT_ZBUF_TEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_ZBUF_TEX</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = -1, .tex_offset = 3, .z_offset = 2,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a z-buffered, textured triangle. </p>
<p >Vertex array format: <code>(float){X, Y, Z, S, T, INV_W}</code> (6 floats) </p>

</div>
</div>
<a id="a42ee16b45c5d7beff9cee7bf96b01b1c" name="a42ee16b45c5d7beff9cee7bf96b01b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ee16b45c5d7beff9cee7bf96b01b1c">&#9670;&nbsp;</a></span>TRIFMT_ZBUF_SHADE_TEX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a> TRIFMT_ZBUF_SHADE_TEX</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= (<a class="code hl_struct" href="structrdpq__trifmt__t.html">rdpq_trifmt_t</a>){</div>
<div class="line">    .pos_offset = 0, .shade_offset = 3, .tex_offset = 7, .z_offset = 2,</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Format descriptor for a z-buffered, shaded, textured triangle. </p>
<p >Vertex array format: <code>(float){X, Y, Z, R, G, B, A, S, T, INV_W}</code> (10 floats) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
