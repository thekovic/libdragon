<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: rspq_internal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7132cdae52f2e6cf943a3c5275a8334f.html">rspq</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">rspq_internal.h File Reference<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__lowlevel.html">Low Level Hardware Interfaces</a> &raquo; <a class="el" href="group__rsp.html">RSP: vector coprocessor</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>RSP Command queue.  
<a href="#details">More...</a></p>

<p><a href="rspq__internal_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structrspq__block__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#structrspq__block__t">rspq_block_t</a></td></tr>
<tr class="memdesc:structrspq__block__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">A rspq block: pre-recorded array of commands.  <a href="rspq__internal_8h.html#structrspq__block__t">More...</a><br /></td></tr>
<tr class="separator:structrspq__block__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structrspq__rdp__mode__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#structrspq__rdp__mode__t">rspq_rdp_mode_t</a></td></tr>
<tr class="memdesc:structrspq__rdp__mode__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">RDP render mode definition.  <a href="rspq__internal_8h.html#structrspq__rdp__mode__t">More...</a><br /></td></tr>
<tr class="separator:structrspq__rdp__mode__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structrspq__overlay__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#structrspq__overlay__t">rspq_overlay_t</a></td></tr>
<tr class="memdesc:structrspq__overlay__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">A RSPQ overlay ucode. This is similar to <a class="el" href="structrsp__ucode__t.html" title="RSP ucode definition.">rsp_ucode_t</a>, but is used internally to managed it as a RSPQ overlay.  <a href="rspq__internal_8h.html#structrspq__overlay__t">More...</a><br /></td></tr>
<tr class="separator:structrspq__overlay__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structrspq__overlay__tables__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#structrspq__overlay__tables__t">rspq_overlay_tables_t</a></td></tr>
<tr class="memdesc:structrspq__overlay__tables__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">The overlay table in DMEM.  <a href="rspq__internal_8h.html#structrspq__overlay__tables__t">More...</a><br /></td></tr>
<tr class="separator:structrspq__overlay__tables__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structrsp__queue__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#structrsp__queue__t">rsp_queue_t</a></td></tr>
<tr class="memdesc:structrsp__queue__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSP Queue data in DMEM.  <a href="rspq__internal_8h.html#structrsp__queue__t">More...</a><br /></td></tr>
<tr class="separator:structrsp__queue__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2c22673267db559e3da95fff1f428427"><td class="memItemLeft" align="right" valign="top"><a id="a2c22673267db559e3da95fff1f428427" name="a2c22673267db559e3da95fff1f428427"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>rspq_int_write</b>(cmd_id, ...)&#160;&#160;&#160;<a class="el" href="rspq_8h.html#aefec193be7de05f725738beeb3775634">rspq_write</a>(0, cmd_id, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:a2c22673267db559e3da95fff1f428427"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write an internal command to the RSP queue. <br /></td></tr>
<tr class="separator:a2c22673267db559e3da95fff1f428427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79d61a437f2eb7ee15a54b30485d580f"><td class="memItemLeft" align="right" valign="top"><a id="a79d61a437f2eb7ee15a54b30485d580f" name="a79d61a437f2eb7ee15a54b30485d580f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RSPQ_DATA_ADDRESS</b>&#160;&#160;&#160;32</td></tr>
<tr class="memdesc:a79d61a437f2eb7ee15a54b30485d580f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Address of the RSPQ data header in DMEM (see <a class="el" href="rspq__internal_8h.html#structrsp__queue__t" title="RSP Queue data in DMEM.">rsp_queue_t</a>) <br /></td></tr>
<tr class="separator:a79d61a437f2eb7ee15a54b30485d580f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aba01db17f4a2bfbc3db60dc172972a25"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a2c76820fdf4fc98985983a7d5ec0a207">RSPQ_CMD_INVALID</a> = 0x00
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25ac263376942e30a199a0193d7c8c19c3c">RSPQ_CMD_NOOP</a> = 0x01
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a58023050f9d78e7cf4dc6c6cee07b6e5">RSPQ_CMD_JUMP</a> = 0x02
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a3bcc1ebb86dbfab31f34d0153d3a9a14">RSPQ_CMD_CALL</a> = 0x03
, <br />
&#160;&#160;<a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25ae3aa621c30e8ea451128c8ff98d14f44">RSPQ_CMD_RET</a> = 0x04
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a4f90128f18e525784c2a00b5d92f5840">RSPQ_CMD_DMA</a> = 0x05
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25ae0ee81ba2ae47bd82a5cf662bab63ca5">RSPQ_CMD_WRITE_STATUS</a> = 0x06
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a8d8fd35254ac74cdb0b1abdb364fb64e">RSPQ_CMD_SWAP_BUFFERS</a> = 0x07
, <br />
&#160;&#160;<a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a150bd208a5199e21f87ee2e093dabe56">RSPQ_CMD_TEST_WRITE_STATUS</a> = 0x08
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a8311a9a6271403dd01632a572a3b6dcf">RSPQ_CMD_RDP_WAIT_IDLE</a> = 0x09
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25aa632d525553a22d75f1ad4cf7d932c4f">RSPQ_CMD_RDP_SET_BUFFER</a> = 0x0A
, <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25abe06e92ff0ad671b894d7406f36caf6a">RSPQ_CMD_RDP_APPEND_BUFFER</a> = 0x0B
<br />
 }</td></tr>
<tr class="separator:aba01db17f4a2bfbc3db60dc172972a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad8d8f0c474f13dded0cf8bcc811ebc32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="rspq__internal_8h.html#structrsp__queue__t">rsp_queue_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rspq__internal_8h.html#ad8d8f0c474f13dded0cf8bcc811ebc32">__rspq_get_state</a> (void)</td></tr>
<tr class="memdesc:ad8d8f0c474f13dded0cf8bcc811ebc32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to a copy of the current RSPQ state.  <a href="rspq__internal_8h.html#ad8d8f0c474f13dded0cf8bcc811ebc32">More...</a><br /></td></tr>
<tr class="separator:ad8d8f0c474f13dded0cf8bcc811ebc32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92634614a959537f611d805b227defb7"><td class="memItemLeft" align="right" valign="top"><a id="a92634614a959537f611d805b227defb7" name="a92634614a959537f611d805b227defb7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rspq_block_run_rsp</b> (int nesting_level)</td></tr>
<tr class="memdesc:a92634614a959537f611d805b227defb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify that a RSP command is going to run a block. <br /></td></tr>
<tr class="separator:a92634614a959537f611d805b227defb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4bb2ee1cdad42a176be51abf5530bc0f"><td class="memItemLeft" align="right" valign="top"><a id="a4bb2ee1cdad42a176be51abf5530bc0f" name="a4bb2ee1cdad42a176be51abf5530bc0f"></a>
volatile int&#160;</td><td class="memItemRight" valign="bottom"><b>__rspq_syncpoints_done</b></td></tr>
<tr class="memdesc:a4bb2ee1cdad42a176be51abf5530bc0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">ID of the last syncpoint reached by RSP. <br /></td></tr>
<tr class="separator:a4bb2ee1cdad42a176be51abf5530bc0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >RSP Command queue. </p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structrspq__block__t" id="structrspq__block__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrspq__block__t">&#9670;&nbsp;</a></span>rspq_block_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rspq_block_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >A rspq block: pre-recorded array of commands. </p>
<p >A block (<a class="el" href="rspq__internal_8h.html#structrspq__block__t" title="A rspq block: pre-recorded array of commands.">rspq_block_t</a>) is a prerecorded sequence of RSP commands that can be played back. Blocks can be created via <a class="el" href="rspq_8h.html#a41f292fc1f7b261f84c55fc356f86acf" title="Begin creating a new block.">rspq_block_begin</a> / <a class="el" href="rspq_8h.html#a81339d69802148a09829d1c6d9a9f9f6" title="Finish creating a block.">rspq_block_end</a>, and then executed by <a class="el" href="rspq_8h.html#ad078c001303a1b2153ba99f3184194f3" title="Add to the RSP queue a command that runs a block.">rspq_block_run</a>. It is also possible to do nested calls (a block can call another block), up to 8 levels deep. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aaeb635d42c80c9b4fb25576d740e209b" name="aaeb635d42c80c9b4fb25576d740e209b"></a>uint32_t</td>
<td class="fieldname">
nesting_level</td>
<td class="fielddoc">
Nesting level of the block. </td></tr>
<tr><td class="fieldtype">
<a id="a82d6fb16d4c24caa5d27ab56e3139b22" name="a82d6fb16d4c24caa5d27ab56e3139b22"></a><a class="el" href="rdpq__internal_8h.html#structrdpq__block__t">rdpq_block_t</a> *</td>
<td class="fieldname">
rdp_block</td>
<td class="fielddoc">
Option RDP static buffer (with RDP commands) </td></tr>
<tr><td class="fieldtype">
<a id="a7e11bb79e816a11c5bd8ccb685d56bf0" name="a7e11bb79e816a11c5bd8ccb685d56bf0"></a>uint32_t</td>
<td class="fieldname">
cmds[]</td>
<td class="fielddoc">
Block contents (commands) </td></tr>
</table>

</div>
</div>
<a name="structrspq__rdp__mode__t" id="structrspq__rdp__mode__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrspq__rdp__mode__t">&#9670;&nbsp;</a></span>rspq_rdp_mode_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rspq_rdp_mode_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >RDP render mode definition. </p>
<p >This is the definition of the current RDP render mode </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a27e4b8a5fb685b55261cbb089f19c153" name="a27e4b8a5fb685b55261cbb089f19c153"></a>uint64_t</td>
<td class="fieldname">
combiner</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0ec3bb20af8d6560a92a5474caeb4684" name="a0ec3bb20af8d6560a92a5474caeb4684"></a>uint64_t</td>
<td class="fieldname">
combiner_mipmapmask</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1f97ab6eb0b92d6a9af4aa33d4c45759" name="a1f97ab6eb0b92d6a9af4aa33d4c45759"></a>uint32_t</td>
<td class="fieldname">
blend_step0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3f75cf93e2c331639e59e624dc30613d" name="a3f75cf93e2c331639e59e624dc30613d"></a>uint32_t</td>
<td class="fieldname">
blend_step1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a91cee581ded34f8a1875a9cb6d3906e4" name="a91cee581ded34f8a1875a9cb6d3906e4"></a>uint64_t</td>
<td class="fieldname">
other_modes</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structrspq__overlay__t" id="structrspq__overlay__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrspq__overlay__t">&#9670;&nbsp;</a></span>rspq_overlay_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rspq_overlay_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >A RSPQ overlay ucode. This is similar to <a class="el" href="structrsp__ucode__t.html" title="RSP ucode definition.">rsp_ucode_t</a>, but is used internally to managed it as a RSPQ overlay. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ac11398286f8a17bfdfef59b65415f36b" name="ac11398286f8a17bfdfef59b65415f36b"></a>uint32_t</td>
<td class="fieldname">
code</td>
<td class="fielddoc">
Address of the overlay code in RDRAM. </td></tr>
<tr><td class="fieldtype">
<a id="ab57b97d3a08046be85e1c8b317643730" name="ab57b97d3a08046be85e1c8b317643730"></a>uint32_t</td>
<td class="fieldname">
data</td>
<td class="fielddoc">
Address of the overlay data in RDRAM. </td></tr>
<tr><td class="fieldtype">
<a id="aca88c0e760ff64ad91115964f819e469" name="aca88c0e760ff64ad91115964f819e469"></a>uint32_t</td>
<td class="fieldname">
state</td>
<td class="fielddoc">
Address of the overlay state in RDRAM (within data) </td></tr>
<tr><td class="fieldtype">
<a id="aab1d173eb125c1e38f231124a1be8c37" name="aab1d173eb125c1e38f231124a1be8c37"></a>uint16_t</td>
<td class="fieldname">
code_size</td>
<td class="fielddoc">
Size of the code in bytes - 1. </td></tr>
<tr><td class="fieldtype">
<a id="ae1297acf518013982275cf0fc9d55213" name="ae1297acf518013982275cf0fc9d55213"></a>uint16_t</td>
<td class="fieldname">
data_size</td>
<td class="fielddoc">
Size of the data in bytes - 1. </td></tr>
</table>

</div>
</div>
<a name="structrspq__overlay__tables__t" id="structrspq__overlay__tables__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrspq__overlay__tables__t">&#9670;&nbsp;</a></span>rspq_overlay_tables_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rspq_overlay_tables_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >The overlay table in DMEM. </p>
<p >This structure is defined in DMEM by rsp_queue.S, and contains the descriptors for the overlays, used by the queue engine to load each overlay when needed. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7620da33bc14957bb57652073d8c57fb" name="a7620da33bc14957bb57652073d8c57fb"></a>uint8_t</td>
<td class="fieldname">
overlay_table[RSPQ_OVERLAY_TABLE_SIZE]</td>
<td class="fielddoc">
Table mapping overlay ID to overlay index (used for the descriptors) </td></tr>
<tr><td class="fieldtype">
<a id="af408fa9bc4a925a0d759e03ca9e21eee" name="af408fa9bc4a925a0d759e03ca9e21eee"></a><a class="el" href="rspq__internal_8h.html#structrspq__overlay__t">rspq_overlay_t</a></td>
<td class="fieldname">
overlay_descriptors[RSPQ_MAX_OVERLAY_COUNT]</td>
<td class="fielddoc">
Descriptor for each overlay, indexed by the previous table. </td></tr>
</table>

</div>
</div>
<a name="structrsp__queue__t" id="structrsp__queue__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structrsp__queue__t">&#9670;&nbsp;</a></span>rsp_queue_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct rsp_queue_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >RSP Queue data in DMEM. </p>
<p >This structure is defined by rsp_queue.S, and represents the top portion of DMEM. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a51cdab2e34ee3d55adb8c548e686c638" name="a51cdab2e34ee3d55adb8c548e686c638"></a><a class="el" href="rspq__internal_8h.html#structrspq__overlay__tables__t">rspq_overlay_tables_t</a></td>
<td class="fieldname">
tables</td>
<td class="fielddoc">
Overlay table. </td></tr>
<tr><td class="fieldtype">
<a id="a4c630b61de8b37527faef64f92972969" name="a4c630b61de8b37527faef64f92972969"></a>uint32_t</td>
<td class="fieldname">
rspq_pointer_stack[RSPQ_MAX_BLOCK_NESTING_LEVEL]</td>
<td class="fielddoc">
Pointer stack used by <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25a3bcc1ebb86dbfab31f34d0153d3a9a14" title="RSPQ command: Call a block.">RSPQ_CMD_CALL</a> and <a class="el" href="rspq__internal_8h.html#aba01db17f4a2bfbc3db60dc172972a25ae3aa621c30e8ea451128c8ff98d14f44" title="RSPQ command: Return from a block.">RSPQ_CMD_RET</a>. </td></tr>
<tr><td class="fieldtype">
<a id="a5e0f8582d01071ec6cbb8ca64cef732b" name="a5e0f8582d01071ec6cbb8ca64cef732b"></a>uint32_t</td>
<td class="fieldname">
rspq_dram_lowpri_addr</td>
<td class="fielddoc">
Address of the lowpri queue (special slot in the pointer stack) </td></tr>
<tr><td class="fieldtype">
<a id="a416de4e7fb92fd08adadbdfadd988bdb" name="a416de4e7fb92fd08adadbdfadd988bdb"></a>uint32_t</td>
<td class="fieldname">
rspq_dram_highpri_addr</td>
<td class="fielddoc">
Address of the highpri queue (special slot in the pointer stack) </td></tr>
<tr><td class="fieldtype">
<a id="a95509523ed0319eedc0c1f243eb11287" name="a95509523ed0319eedc0c1f243eb11287"></a>uint32_t</td>
<td class="fieldname">
rspq_dram_addr</td>
<td class="fielddoc">
Current RDRAM address being processed. </td></tr>
<tr><td class="fieldtype">
<a id="a3127fa994393137dd5db3af0665dfeec" name="a3127fa994393137dd5db3af0665dfeec"></a>uint32_t</td>
<td class="fieldname">
rspq_rdp_sentinel</td>
<td class="fielddoc">
Current RDP RDRAM end pointer (when rdp_current reaches this, the buffer is full) </td></tr>
<tr><td class="fieldtype">
<a id="a8ec5b9f0315c446369d65a828182c80d" name="a8ec5b9f0315c446369d65a828182c80d"></a><a class="el" href="rspq__internal_8h.html#structrspq__rdp__mode__t">rspq_rdp_mode_t</a></td>
<td class="fieldname">
rdp_mode</td>
<td class="fielddoc">
RDP current render mode definition. </td></tr>
<tr><td class="fieldtype">
<a id="aaf03cf478da7d3bbac28add5e4e67263" name="aaf03cf478da7d3bbac28add5e4e67263"></a>uint64_t</td>
<td class="fieldname">
rdp_scissor_rect</td>
<td class="fielddoc">
Current RDP scissor rectangle. </td></tr>
<tr><td class="fieldtype">
<a id="a658c3e9ce652b6efe1d8c4481376bc38" name="a658c3e9ce652b6efe1d8c4481376bc38"></a>uint32_t</td>
<td class="fieldname">
rspq_rdp_buffers[2]</td>
<td class="fielddoc">
RDRAM Address of dynamic RDP buffers. </td></tr>
<tr><td class="fieldtype">
<a id="a415b30de8d27a1cc60f6e09e59c2319f" name="a415b30de8d27a1cc60f6e09e59c2319f"></a>uint32_t</td>
<td class="fieldname">
rspq_rdp_current</td>
<td class="fielddoc">
Current RDP RDRAM write pointer (normally DP_END) </td></tr>
<tr><td class="fieldtype">
<a id="abe097bf8767f8c3caaa02a0e3dd633fc" name="abe097bf8767f8c3caaa02a0e3dd633fc"></a>uint32_t</td>
<td class="fieldname">
rdp_fill_color</td>
<td class="fielddoc">
Current RDP fill color. </td></tr>
<tr><td class="fieldtype">
<a id="a85ccbeaa6742d838a2dd3fadcf7c3a01" name="a85ccbeaa6742d838a2dd3fadcf7c3a01"></a>uint8_t</td>
<td class="fieldname">
rdp_target_bitdepth</td>
<td class="fielddoc">
Current RDP target buffer bitdepth. </td></tr>
<tr><td class="fieldtype">
<a id="a808fa93797ada04a5122a0cc97ae5619" name="a808fa93797ada04a5122a0cc97ae5619"></a>uint8_t</td>
<td class="fieldname">
rdp_syncfull_ongoing</td>
<td class="fielddoc">
True if a SYNC_FULL is currently ongoing. </td></tr>
<tr><td class="fieldtype">
<a id="afb00700ee7080c68f9b26735936cd9dc" name="afb00700ee7080c68f9b26735936cd9dc"></a>uint8_t</td>
<td class="fieldname">
rdpq_debug</td>
<td class="fielddoc">
Debug mode flag. </td></tr>
<tr><td class="fieldtype">
<a id="affeec192a58ce5fbf4857a18e8fd8b44" name="affeec192a58ce5fbf4857a18e8fd8b44"></a>uint8_t</td>
<td class="fieldname">
__padding0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9efe1eba42ba7e4d1f54e5101214bb86" name="a9efe1eba42ba7e4d1f54e5101214bb86"></a>int16_t</td>
<td class="fieldname">
current_ovl</td>
<td class="fielddoc">
Current overlay index. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aba01db17f4a2bfbc3db60dc172972a25" name="aba01db17f4a2bfbc3db60dc172972a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba01db17f4a2bfbc3db60dc172972a25">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >RSPQ internal commands (overlay 0) </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a2c76820fdf4fc98985983a7d5ec0a207" name="aba01db17f4a2bfbc3db60dc172972a25a2c76820fdf4fc98985983a7d5ec0a207"></a>RSPQ_CMD_INVALID&#160;</td><td class="fielddoc"><p >RSPQ command: Invalid. </p>
<p >Reserved ID for invalid command. This is used as a marker so that RSP knows when it has caught up with CPU and reached an empty portion of the buffer. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25ac263376942e30a199a0193d7c8c19c3c" name="aba01db17f4a2bfbc3db60dc172972a25ac263376942e30a199a0193d7c8c19c3c"></a>RSPQ_CMD_NOOP&#160;</td><td class="fielddoc"><p >RSPQ command: No-op. </p>
<p >This commands does nothing. It can be useful for debugging purposes. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a58023050f9d78e7cf4dc6c6cee07b6e5" name="aba01db17f4a2bfbc3db60dc172972a25a58023050f9d78e7cf4dc6c6cee07b6e5"></a>RSPQ_CMD_JUMP&#160;</td><td class="fielddoc"><p >RSPQ command: Jump to another buffer. </p>
<p >This commands tells the RSP to start fetching commands from a new address. It is mainly used internally to implement the queue as a ring buffer (jumping at the start when we reach the end of the buffer). </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a3bcc1ebb86dbfab31f34d0153d3a9a14" name="aba01db17f4a2bfbc3db60dc172972a25a3bcc1ebb86dbfab31f34d0153d3a9a14"></a>RSPQ_CMD_CALL&#160;</td><td class="fielddoc"><p >RSPQ command: Call a block. </p>
<p >This command is used by the block functions to implement the execution of a block. It tells RSP to starts fetching commands from the block address, saving the current address in an internal save slot in DMEM, from which it will be recovered by CMD_RET. Using multiple slots allow for nested calls. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25ae3aa621c30e8ea451128c8ff98d14f44" name="aba01db17f4a2bfbc3db60dc172972a25ae3aa621c30e8ea451128c8ff98d14f44"></a>RSPQ_CMD_RET&#160;</td><td class="fielddoc"><p >RSPQ command: Return from a block. </p>
<p >This command tells the RSP to recover the buffer address from a save slot (from which it was currently saved by a CALL command) and begin fetching commands from there. It is used to finish the execution of a block. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a4f90128f18e525784c2a00b5d92f5840" name="aba01db17f4a2bfbc3db60dc172972a25a4f90128f18e525784c2a00b5d92f5840"></a>RSPQ_CMD_DMA&#160;</td><td class="fielddoc"><p >RSPQ command: DMA transfer. </p>
<p >This commands runs a DMA transfer (either DRAM to DMEM, or DMEM to DRAM). It is used by <a class="el" href="rspq_8h.html#a072c51be5126cfe5f914aefc52de950a" title="Register a rspq overlay into the RSP queue engine.">rspq_overlay_register</a> to register a new overlay table into DMEM while the RSP is already running (to allow for overlays to be registered even after boot), and can be used by the users to perform manual DMA transfers to and from DMEM without risking a conflict with the RSP itself. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25ae0ee81ba2ae47bd82a5cf662bab63ca5" name="aba01db17f4a2bfbc3db60dc172972a25ae0ee81ba2ae47bd82a5cf662bab63ca5"></a>RSPQ_CMD_WRITE_STATUS&#160;</td><td class="fielddoc"><p >RSPQ Command: write SP_STATUS register. </p>
<p >This command asks the RSP to write to the SP_STATUS register. It is normally used to set/clear signals or to raise RSP interrupts. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a8d8fd35254ac74cdb0b1abdb364fb64e" name="aba01db17f4a2bfbc3db60dc172972a25a8d8fd35254ac74cdb0b1abdb364fb64e"></a>RSPQ_CMD_SWAP_BUFFERS&#160;</td><td class="fielddoc"><p >RSPQ Command: Swap lowpri/highpri buffers. </p>
<p >This command is used as part of the highpri feature. It allows to switch between lowpri and highpri queue, by saving the current buffer pointer in a special save slot, and restoring the buffer pointer of the other queue from another slot. In addition, it also writes to SP_STATUS, to be able to adjust signals: entering highpri mode requires clearing SIG_HIGHPRI_REQUESTED and setting SIG_HIGHPRI_RUNNING; exiting highpri mode requires clearing SIG_HIGHPRI_RUNNING.</p>
<p >The command is called internally by RSP to switch to highpri when the SIG_HIGHPRI_REQUESTED is found set; then it is explicitly enqueued by the CPU when the highpri queue is finished to switch back to lowpri (see <a class="el" href="rspq_8h.html#ae495b6d8ec49169f05e523fe564f9f4b" title="Finish building the high-priority queue and close it.">rspq_highpri_end</a>). </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a150bd208a5199e21f87ee2e093dabe56" name="aba01db17f4a2bfbc3db60dc172972a25a150bd208a5199e21f87ee2e093dabe56"></a>RSPQ_CMD_TEST_WRITE_STATUS&#160;</td><td class="fielddoc"><p >RSPQ Command: Test and write SP_STATUS register. </p>
<p >This commands does a test-and-write sequence on the SP_STATUS register: first, it waits for a certain mask of bits to become zero, looping on it. Then it writes a mask to the register. It is used as part of the syncpoint feature to raise RSP interrupts, while waiting for the previous interrupt to be processed (coalescing interrupts would cause syncpoints to be missed). </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25a8311a9a6271403dd01632a572a3b6dcf" name="aba01db17f4a2bfbc3db60dc172972a25a8311a9a6271403dd01632a572a3b6dcf"></a>RSPQ_CMD_RDP_WAIT_IDLE&#160;</td><td class="fielddoc"><p >RSPQ command: Wait for RDP to be idle. </p>
<p >This command will let the RSP spin-wait until the RDP is idle (that is, the DP_STATUS_BUSY bit in COP0_DP_STATUS goes to 0). Notice that the RDP is fully asynchronous, and reading DP_STATUS_BUSY basically makes sense only after a RDP SYNC_FULL command (<a class="el" href="rdpq_8c.html#aa667aafb95c47fac38f4fa2c2c13f1fb" title="Schedule a RDP SYNC_FULL command and register a callback when it is done.">rdpq_sync_full()</a>), when it really does make sure that all previous commands have finished running. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25aa632d525553a22d75f1ad4cf7d932c4f" name="aba01db17f4a2bfbc3db60dc172972a25aa632d525553a22d75f1ad4cf7d932c4f"></a>RSPQ_CMD_RDP_SET_BUFFER&#160;</td><td class="fielddoc"><p >RSPQ Command: send a new buffer to RDP and/or configure it for new commands. </p>
<p >This command configures a new buffer in RSP for RDP commands. A buffer is described with three pointers: start, cur, sentinel.</p>
<p >Start is the beginning of the buffer. Cur is the current write pointer in the buffer. If start==cur, it means the buffer is currently empty; otherwise, it means it contains some RDP commands that will be sent to RDP right away. Sentinel is the end of the buffer. If cur==sentinel, the buffer is full and no more commands will be written to it. </p>
</td></tr>
<tr><td class="fieldname"><a id="aba01db17f4a2bfbc3db60dc172972a25abe06e92ff0ad671b894d7406f36caf6a" name="aba01db17f4a2bfbc3db60dc172972a25abe06e92ff0ad671b894d7406f36caf6a"></a>RSPQ_CMD_RDP_APPEND_BUFFER&#160;</td><td class="fielddoc"><p >RSPQ Command: send more data to RDP (appended to the end of the current buffer) </p>
<p >This commands basically just sets DP_END to the specified argument, allowing new commands appended in the current buffer to be sent to RDP. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad8d8f0c474f13dded0cf8bcc811ebc32" name="ad8d8f0c474f13dded0cf8bcc811ebc32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d8f0c474f13dded0cf8bcc811ebc32">&#9670;&nbsp;</a></span>__rspq_get_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="rspq__internal_8h.html#structrsp__queue__t">rsp_queue_t</a> * __rspq_get_state </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a pointer to a copy of the current RSPQ state. </p>
<dl class="section note"><dt>Note</dt><dd>This function forces a full sync by calling <a class="el" href="rspq_8h.html#af3055d289f73a125e15b72429cfc91ed" title="Wait until all commands in the queue have been executed by RSP.">rspq_wait</a> to avoid race conditions. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
